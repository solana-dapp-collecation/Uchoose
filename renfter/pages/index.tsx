import {useCeramic} from "use-ceramic";
import type {NextPage} from 'next'
import Head from 'next/head'
import Image from 'next/image'
import Link from "next/link";
import styles from '../styles/Home.module.css'
import React, {useEffect, useState} from "react";
import topBarStyles from '../styles/top-bar.module.scss';
import Section from "../components/carousel-component/section";
import Carousel from 'react-multi-carousel';
import WithScrollbar from '../components/carousel-component/withScrollbar';
import "react-multi-carousel/lib/styles.css";
import CustomCarouselWithCards from "../components/carousel-component/customCarouselComponent";


// function SignInWithCeramic(props: React.PropsWithChildren<{}>) {
//     const ceramic = useCeramic();
//     const [authenticated, setAuthenticated] = useState(ceramic.isAuthenticated);
//     const [progress, setProgress] = useState(false);
//
//     useEffect(() => {
//         const subscription = ceramic.isAuthenticated$.subscribe(
//             (isAuthenticated) => {
//                 setAuthenticated(isAuthenticated);
//             }
//         );
//
//         return () => {
//             subscription.unsubscribe();
//         };
//     });
//
//     const handleLogin = async () => {
//         setProgress(true);
//         try {
//             const authProvider = await ceramic.connect();
//             await ceramic.authenticate(authProvider);
//         } catch (e) {
//             console.error(e);
//         } finally {
//             setProgress(false);
//         }
//     };
//
//     const renderButton = () => {
//         if (progress) {
//             return (
//                 <>
//                     <button disabled={true}>Connecting...</button>
//                 </>
//             );
//         } else {
//             return (
//                 <>
//                     <button onClick={handleLogin}>Sign In</button>
//                 </>
//             );
//         }
//     };
//
//     if (authenticated) {
//         return <>{props.children}</>;
//     } else {
//         return renderButton();
//     }
// }

const Home: NextPage = () => {

    const ceramic = useCeramic();
    const [isAuthenticated, setAuthenticated] = useState(ceramic.isAuthenticated);
    const [progress, setProgress] = useState(false);

    useEffect(() => {
        const subscription = ceramic.isAuthenticated$.subscribe(
            (isAuthenticated) => {
                setAuthenticated(isAuthenticated);
            }
        );

        return () => {
            subscription.unsubscribe();
        };
    });

    const handleLogin = async () => {
        setProgress(true);
        try {
            const authProvider = await ceramic.connect();
            await ceramic.authenticate(authProvider);
        } catch (e) {
            console.error(e);
        } finally {
            setProgress(false);
        }
    };

    const renderButton = () => {
        if (progress) {
            return (
                <>
                    <button disabled={true}>Connecting...</button>
                </>
            );
        } else {
            return (
                <>
                    <button onClick={handleLogin}>Sign In</button>
                </>
            );
        }
    };

    return (
        <div className={styles.container}>
            <Head>
                <title>Uch∞se</title>
                <meta name="description" content="Generated by create next app"/>
                <link rel="icon" href="/main-logo-2.png"/>
            </Head>

            {/*Top bar*/}
            <div className={topBarStyles.topBarContainer}>
                <div className={styles.logo}
                     style={{display: 'inline-block', verticalAlign: 'middle', marginRight: '10px'}}>
                    <img src="/main-logo-2.png" alt="ReNFTeЯ" style={{width: '100px'}}/>
                </div>
                <div style={{display: 'inline-block', verticalAlign: 'middle', marginTop: '30px'}}>
                    {/*<SignInWithCeramic>*/}
                    {/*    <div className={"text-center w-full"}>*/}
                    {/*        <hr/>*/}
                    {/*        <Link href={"/mint"} shallow={true}>*/}
                    {/*            Mint*/}
                    {/*        </Link>{" "}*/}
                    {/*        or{" "}*/}
                    {/*        <Link href={"/view"} shallow={true}>*/}
                    {/*            View*/}
                    {/*        </Link>*/}
                    {/*    </div>*/}
                    {/*</SignInWithCeramic>*/}
                </div>
            </div>
            {/*Main body*/}
            <main className={styles.main}>
                <div className={styles.grid} style={{marginTop: '0px'}}>
                    <a className={`${styles.card} ${styles.cardDisabled}`}>
                        <h2>Manage collections &rarr;</h2>
                        <p>To create your collection. Доступна всегда, если нет, то окно с аутентификацией</p>
                    </a>
                    <a className={`${styles.card} ${styles.cardDisabled}`}>
                        <h2>View &rarr;</h2>
                        <p>View existing collection. Все коллекции видны ниже</p>
                    </a>
                    <a className={`${styles.card} ${styles.cardDisabled}`}>
                        <h2>Transactions &rarr;</h2>
                        <p>See available transactions</p>
                    </a>
                    <a className={`${styles.card} ${styles.cardDisabled}`}>
                        <h2>Logs/Statistics &rarr;</h2>
                        <p>
                            See logs and statistics
                        </p>
                    </a>
                </div>
                {/* <div>
                    <CarouselWithCards/>
                </div> */}
                <div style={{marginTop: '1vh'}}>
                    <CustomCarouselWithCards/>
                </div>
            </main>

            <footer className={styles.footer}>
                <a
                    href="https://vercel.com?utm_source=create-next-app&utm_medium=default-template&utm_campaign=create-next-app"
                    target="_blank"
                    rel="noopener noreferrer"
                >
                    Made by{' '}
                    <span className={styles.logo}>
                        <img src="/main-logo.png" alt="LifeLoopTeam" style={{width: '120px', marginTop: '-15px'}}/>
                    </span>
                </a>
            </footer>
        </div>
    )
}

export default Home
